<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>PALOMA App Server</title>

    <link rel="stylesheet" href="/index.css"/>
    <script defer src="/index.js"></script>
</head>

<body>
<h1>PALOMA Test API Server</h1>
<p>
    My app API test platform is described below. Some APIs require a request body to be sent (like
    <code>/auth/login</code> and <code>/auth/register</code>), while others require an Authorization authToken
    (received at login). To view the required JSON format, click on a command below and look at the example request
    body. To try out an API, modify the request as needed, and press Send.
</p>

<h2>HTTP Endpoints</h2>
<table>
    <tr>
        <td class="endpoint" onclick="register()">
            <div class="method">[POST]</div>
            <div class="path">/auth/register</div>
        </td>
        <td>
            <span class="description">Register a user</span> Creates a new user account. Returns user data on success.
            No authorization token required.
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="login()">
            <div class="method">[POST]</div>
            <div class="path">/auth/login</div>
        </td>
        <td>
            <span class="description">Log in a user</span> Authenticates user and returns JWT access and refresh tokens.
            No authorization token required.
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="logout()">
            <div class="method">[POST]</div>
            <div class="path">/insession/logout</div>
        </td>
        <td>
            <span class="description">Logs out an authenticated user</span> Revokes all refresh tokens for the user.
            An authorization token is required. No request body is needed as the system uses the access token 
            to identify the user and revoke all their refresh tokens.
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="refresh()">
            <div class="method">[POST]</div>
            <div class="path">/insession/refresh</div>
        </td>
        <td>
            <span class="description">Refresh access token</span> Uses refresh token to generate a new access token.
            An authorization token is required. Requires valid refresh token in request body.
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="dailyCheckIn()">
            <div class="method">[POST]</div>
            <div class="path">/insession/daily/checkin</div>
        </td>
        <td>
            <span class="description">Submits a daily check-in with mood, energy, motivation, and suicidal scores</span>
            An authorization token is required. Requires scores and optional notes.
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="getOverallScores()">
            <div class="method">[POST]</div>
            <div class="path">/insession/daily/checkin/getOverallScores</div>
        </td>
        <td>
            <span class="description">Retrieves overall scores for the specified number of days</span>
            An authorization token is required. Requires numberOfDays parameter in request body.
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="addMedication()">
            <div class="method">[POST]</div>
            <div class="path">/insession/add/medication</div>
        </td>
        <td>
            <span class="description">Adds a new medication to the user's profile</span>
            An authorization token is required. Requires medicationName, dosage, and schedule.
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="dailyMedLog()">
            <div class="method">[POST]</div>
            <div class="path">/insession/daily/medlog</div>
        </td>
        <td>
            <span class="description">Logs that a medication was taken today</span>
            An authorization token is required. Requires medicationName.
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="updateMedication()">
            <div class="method">[PUT]</div>
            <div class="path">/loggedIn</div>
        </td>
        <td>
            <span class="description">Updates medications if they change</span>
            An authToken is required
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="getMedications()">
            <div class="method">[GET]</div>
            <div class="path">/loggedIn</div>
        </td>
        <td>
            <span class="description">gets all the medications for the user</span>
            An authToken is required
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="addContact()">
            <div class="method">[POST]</div>
            <div class="path">/insession/add/contact</div>
        </td>
        <td>
            <span class="description">User adds a trusted contact to their profile</span>
            An authorization token is required. Requires email and optional messageOnNotify.
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="removeContact()">
            <div class="method">[DELETE]</div>
            <div class="path">/insession/remove/contact</div>
        </td>
        <td>
            <span class="description">User removes a trusted contact from their profile</span>
            An authorization token is required. Requires email of the contact to remove.
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="addAlertSensitivity()">
            <div class="method">[POST]</div>
            <div class="path">/insession/add/sensitivityLevel</div>
        </td>
        <td>
            <span class="description">User adds an alert sensitivity level to their profile</span>
            An authorization token is required. Requires sensitivityLevel (LOW, MEDIUM, or HIGH).
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="updateAlertSensitivity()">
            <div class="method">[PUT]</div>
            <div class="path">/insession/update/sensitivityLevel</div>
        </td>
        <td>
            <span class="description">User updates their alert sensitivity level</span>
            An authorization token is required. Requires sensitivityLevel (LOW, MEDIUM, or HIGH).
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="updateEmail()">
            <div class="method">[PUT]</div>
            <div class="path">/insession/update/email</div>
        </td>
        <td>
            <span class="description">Updates user's email address</span>
            An authorization token is required. Requires newEmail in request body.
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="updatePassword()">
            <div class="method">[PUT]</div>
            <div class="path">/insession/update/password</div>
        </td>
        <td>
            <span class="description">Updates user's password</span>
            An authorization token is required. Requires oldPassword and newPassword in request body.
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="updateUsername()">
            <div class="method">[PUT]</div>
            <div class="path">/insession/update/username</div>
        </td>
        <td>
            <span class="description">Updates user's username</span>
            An authorization token is required. Requires newUsername in request body.
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="getContacts()">
            <div class="method">[GET]</div>
            <div class="path">/loggedIn</div>
        </td>
        <td>
            <span class="description">Updates contact info</span>
            An authToken is required
        </td>
    </tr>
    <tr>
        <td class="endpoint" onclick="clearAll()">
            <div class="method">[DELETE]</div>
            <div class="path">/db</div>
        </td>
        <td>
            <span class="description">Clear ALL data from the database</span> No
            authorization authToken is required.
        </td>
    </tr>
</table>

<h2>Execute HTTP Request</h2>
<div class="box">
    <h3>Request</h3>
    <div class="input">
        <label for="method">Method:</label> <input type="text" id="method"/>
    </div>

    <div class="input">
        <label for="handleBox">Endpoint:</label> <input type="text" id="handleBox" name="handleBox"/>
    </div>

    <div class="input">
        <label for="authToken">Auth Token:</label> <input type="text" id="authToken" name="authToken"/>
    </div>

    <div class="input">
        <label for="requestBox">Request Body:</label> <textarea id="requestBox" name="requestBox"></textarea>
    </div>

    <button onclick="submit()">Send</button>
</div>
<div id="responseBox" class="box">
    <h3>HTTP Response</h3>
    <pre id="response" readonly></pre>
</div>
</body>
</html>
